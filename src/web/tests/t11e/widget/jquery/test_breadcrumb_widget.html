<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
    <head>
        <title>
            Test Breadcrumb
        </title>
        <link href="../../../../build/yui-2.7.0.min.css" rel="stylesheet" type="text/css" />
        <link href="../../../../build/jquery-ui-1.7.2.min.css" rel="stylesheet" type="text/css" />
        <link href="../../../../build/widgets.min.css" rel="stylesheet" type="text/css" />
        <link href="../../../../build/widgets-theme-simple.min.css" rel="stylesheet" type="text/css" />
        <link href="../../../../build/qunit.min.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
<script type="text/javascript">
//<!--
    if ('undefined' === typeof t11e) { t11e = {}; }
    if ('undefined' === typeof t11e.widget_options) { t11e.widget_options = {}; }
//-->
</script>
        <div id="doc3" class="yui-t3">
            <div id="hd" role="banner">
              <h1>Test Breadcrumb</h1>
              <p><a href="index.html">Back</a></p>
            </div>
            <div id="bd" role="main">
                <div id="yui-main">
                    <div class="yui-b">
                        <div class="yui-g">

                            <h1 id="qunit-header">QUnit Test Suite</h1>
                            <h2 id="qunit-banner"></h2>
                            <div id="qunit-testrunner-toolbar"></div>
                            <h2 id="qunit-userAgent"></h2>
                            <ol id="qunit-tests"></ol>
                        </div>
                    </div>
                </div>
                <div class="yui-b">

<div class="t11e-widget t11e-widget-jquery-params t11e-widget-id-params">
    <div class="t11e-hd t11e-widget-jquery-params-hd"><h1>Search Params</h1></div>
    <div class="t11e-bd t11e-widget-jquery-params-bd">
        <div class="t11e-params"></div>
    </div>
    <div class="t11e-ft t11e-widget-jquery-results-ft"></div>
</div>
<script type="text/javascript">
//<!--
    t11e.widget_options['params'] = {
        "search_group": "default"
    };
//-->
</script>

<div class="t11e-widget t11e-widget-jquery-button t11e-widget-id-clear">
    <div class="t11e-hd t11e-widget-jquery-button-hd"></div>
    <div class="t11e-bd t11e-widget-jquery-button-bd">
        <a href="#">Clear</a>
     </div>
    <div class="t11e-ft t11e-widget-jquery-button-ft"></div>
</div>
<script type="text/javascript">
//<!--
   t11e.widget_options['clear'] = {
       "search_group": "default",
       "event_name": "clear_search.${search_group}"
   };
//-->
</script>

<div class="t11e-widget t11e-widget-jquery-breadcrumb t11e-widget-id-bc1">
    <div class="t11e-hd t11e-widget-jquery-breadcrumb-hd"><h1>Breadcrumb</h1></div>
    <div class="t11e-bd t11e-widget-jquery-breadcrumb-bd"></div>
    <div class="t11e-ft t11e-widget-jquery-breadcrumb-ft"></div>
</div>
<script type="text/javascript">
//<!--
    t11e.widget_options['bc1'] = {
        "search_group": "default",
        "value_params": [
            "param1",
            "param2"
        ]
    };
//-->
</script>

                </div>
            </div>

            <div id="ft" role="contentinfo">
            </div>
        </div>
        <script type="text/javascript" src="../../../../build/jquery-1.3.2.js" charset="utf-8"></script>
        <script type="text/javascript" src="../../../../build/jquery-ui-1.7.2.js" charset="utf-8"></script>
        <script type="text/javascript" src="../../../../build/widgets.js" charset="utf-8"></script>
        <script type="text/javascript" src="../../../../build/qunit.js" charset="utf-8"></script>
        <script type="text/javascript">//<![CDATA[
        (function ($) {
            t11e.widget.jquery.activate_widgets($);
            var options = {"search_groups": {"default": {"url": "../../../../php/t11e_tutorial.php"}}};
            options.history_plugin = t11e.widget.jquery.history_plugin($);
            options.search_plugin = t11e.widget.jquery.search_plugin($);
            t11e.widget.activate_search_page(options);
        }(jQuery));

        var add_param = function (params, param, value) {
            var values = params[param];
            if (t11e.util.is_undefined(values)) {
                params[param] = [value];
            } else if (-1 === $.inArray(value, values)) {
                values.push(value);
            }
        };

        module("breadcrumbs", {
            setup: function() {
                $('.t11e-widget-jquery-button-bd a').trigger('click');
            },
            teardown: function() {
                //pass
            }
        });

        test('Options', function () {
            var breadcrumb = $('.t11e-widget-jquery-breadcrumb:first');
            same(breadcrumb.t11e_breadcrumb('option', 'page_param'), 'page', 'page_param should be "page"');
            same(breadcrumb.t11e_breadcrumb('option', 'value_params').length, 2, 'value_params length should be 2');
            same(breadcrumb.t11e_breadcrumb('option', 'animate'), false, 'animate should be "false"');
            breadcrumb.t11e_breadcrumb('option', 'animate', true);
            same(breadcrumb.t11e_breadcrumb('option', 'animate'), true, 'animate should be "true"');
            breadcrumb.t11e_breadcrumb('option', 'animate', false);
            same(breadcrumb.t11e_breadcrumb('option', 'animate'), false, 'animate should be "false"');
            same(breadcrumb.t11e_breadcrumb('option', 'animation_speed'), 'fast', 'animation_speed should be "fast"');
        });

        test('Save to params', function () {

            t11e.event.trigger('update_request.default', function (params) {
                add_param(params, 'param1', 'value1');
            });

            same($('.t11e-breadcrumb').length, 1, 'There should be 1 breadcrumb item');

            t11e.event.trigger('update_request.default', function (params) {
                add_param(params, 'param2', 'value1');
            });

            t11e.event.trigger('update_request.default', function (params) {
                add_param(params, 'param2', 'value2');
            });

            same($('.t11e-breadcrumb').length, 3, 'There should be 3 breadcrumb items');

        });

        asyncTest('Remove from params', function () {
            t11e.event.trigger('update_request.default', function (params) {
                add_param(params, 'param1', 'value1');
            });

            t11e.event.trigger('update_request.default', function (params) {
                add_param(params, 'param2', 'value1');
            });

            t11e.event.trigger('update_request.default', function (params) {
                add_param(params, 'param2', 'value2');
            });

            same($('.t11e-breadcrumb').length, 3, 'There should be 3 breadcrumb items');

            var clicked_item = $('.t11e-breadcrumb > a')[0];
            $(clicked_item).trigger('click');

            setTimeout(function() {
                same($('.t11e-breadcrumb').length, 2, 'There should be 2 breadcrumb items');

                start();
            }, 100)

        });

        //]]></script>
    </body>
</html>
